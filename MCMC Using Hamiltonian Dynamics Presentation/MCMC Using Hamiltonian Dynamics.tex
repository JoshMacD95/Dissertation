\documentclass{beamer}
%
% Choose how your presentation looks.
%
% For more themes, color themes and font themes, see:
% http://deic.uab.es/~iblanes/beamer_gallery/index_by_theme.html
%
\mode<presentation>
{
  \usetheme{Warsaw}      % or try Darmstadt, Madrid, Warsaw, ...
  \usecolortheme{default} % or try albatross, beaver, crane, ...
  \usefonttheme{default}  % or try serif, structurebold, ...
  \setbeamertemplate{navigation symbols}{}
  \setbeamertemplate{caption}[numbered]
} 
\usepackage{animate}
\usepackage[english]{babel}
\usepackage[utf8]{inputenc}
\title[MCMC using Hamiltonian Dynamics]{Markov Chain Monte Carlo using Hamiltonian Dynamics}
\author{Joshua James MacDonald}
\institute{}
\date{\today}
\begin{document}

% ===============================================

\begin{frame}
  \titlepage
\end{frame}

% Uncomment these lines for an automatically generated outline.
%\begin{frame}{Outline}
%  \tableofcontents
%\end{frame}

% ===============================================

\section{Motivation for HMC}

% ===============================================

\begin{frame}{Performance of MCMC}

\begin{itemize}
\item MCMC is used to simulate a dependent samples from intractable distributions \vskip 5mm

\item  The Performance of MCMC in high dimensions has become important with the rise of Big Data \vskip 5mm

\item How far can we move with each proposal while keeping a reasonable acceptance rate? \vskip 5mm

\end{itemize}

\end{frame}


\begin{frame}{Motivation for HMC}

\begin{table}
\centering
\begin{tabular}{|c||c|c|}
\hline
Algorithm & Scaling & Optimal Acceptance Rate $(d \to \infty)$ \\
\hline
RWM & $d^{-1/2}$ & $23.4\%$ (Roberts \& Rosenthal 2001) \\
MALA & $d^{-1/3}$ & $57.4\%$ (Roberts \& Rosenthal 2001) \\
HMC & $d^{-1/4}$ & $64\%$ (Beskos et. al. 2010) \\
\hline
\end{tabular}
\end{table}

\end{frame}

% ===============================================

\section{Hamiltonian Dynamics}

% ===============================================

\begin{frame}{Extended Parameter Space}
\begin{itemize}
\item A ball rolling around a potential surface \vskip 5mm
\item At any time the ball has displacement $x$ and momentum $p$ \vskip 5mm
\item Also has a mass $m$ \vskip 5mm
\end{itemize}
\end{frame}
% ==== 

\begin{frame}{Hamiltonian Dynamics}

\begin{figure}
\centering
\animategraphics[scale = 0.4, loop = true]{20}{Animations/First_Normal_Potential}{001}{101}
\end{figure}
\end{frame}


\begin{frame}{The Hamiltonian}
Potential Energy,
\begin{equation*}
U(x) = - \log \{\pi(x)\}
\end{equation*}

Kinetic Energy,
\begin{equation*}
K(p; m) = \frac{1}{2} \frac{p^2}{m}
\end{equation*}

The Hamiltonian,
\begin{equation*}
H(x, p; m) = U(x) + K(p;m)
\end{equation*}
\end{frame}

% ==== 
\begin{frame}{Hamiltonian Equations}

\begin{equation*}
\frac{dx}{dt} = \frac{p}{m}
\end{equation*}

\begin{equation*}
\frac{dp}{dt} = - \frac{dU}{dx}
\end{equation*}

Can be generalised to higher dimensions

\begin{equation*}
\frac{dx}{dt} = M^{-1}p
\end{equation*}

\begin{equation*}
\frac{dp}{dt} = - \nabla U(x)
\end{equation*}

\end{frame}
% ==== 

\begin{frame}{1-dimensional Gaussian Example}
% Graph of N(0,1) Density
% Graph of log(N(0,1))
% Graphic of Ball rolling around -log(N(0,1))
\begin{figure}
\centering
\animategraphics[scale = 0.4, loop = true]{20}{Animations/Normal_Potential}{001}{101}
\end{figure}
\end{frame}

% ====

\begin{frame}{Approximating Hamiltonian Dynamics}

\begin{itemize}
\item Hamiltonian Dynamics are approximated using a numerical discretisation. 

\item Simulate over time $T$, using $L$ steps and stepsize $\varepsilon$

\item When used in MCMC, gives acceptance probability $$ \alpha(x^{*}, p^{*} ;x, p) = \min \Big{\{} 1, \exp(-(H(x^{*}, p^{*};M) - H(x,p;M)) \Big{\}} $$

\end{itemize}

\end{frame}





%\begin{frame}{Why Hamiltonian Dynamics?}
%\begin{itemize}
%\item Reversibility of Hamiltonian Dynamics ensures Detailed Balance. \vskip 5mm

%\item If Hamiltonian is conserved, we have acceptance probability of 1 \vskip 5mm

%\item Volume Preservation \vskip 5mm
%\end{itemize}
%\end{frame}

% ====

%\begin{frame}{Leapfrog Approximation (St√∂rmer-Verlet)}

%\begin{itemize}
%\item A method of approximating Hamiltonian Dynamics \vskip 5mm

%\item Preserves the desirable properties of Hamiltonian Dynamics \vskip 5mm

%\item Approximately conserves the Hamiltonian \vskip 5mm

%\item $T$, Integration Time \vskip 5mm 

%\item $\varepsilon$, stepsize \vskip 5mm

%\item $L$, Leapfrog steps \vskip 5mm
%\end{itemize}

%\begin{equation}
%T = L \varepsilon 
%\end{equation}

%\end{frame}

% ===============================================
\section{HMC Algorithm}
% ==============================================

\begin{frame}{HMC Algorithm}
\begin{itemize}

\item We have some position $x$.

\item Draw a new momentum $ p \sim \mathcal{N}(0, M)$.

\item Approximate Hamiltonian Dynamics for time $T$ in $L$ steps, using stepsize $\varepsilon$. 

\item Proposes new position and momentum $(x^{*}, p^{*})$. 

\item Accept proposal with probability $$ \alpha(x^{*}, p^{*} ;x, p) = \min \Big{\{} 1, \exp(-(H(x^{*}, p^{*};M) - H(x,p;M)) \Big{\}} $$
\end{itemize}

\end{frame}


% ===============================================
\section{Tuning the HMC Algorithm}
% ===============================================

\begin{frame}{Choosing a Stepsize}

\begin{itemize}
\item Approximation can become unstable if the chosen stepsize is too large

\item On the other hand,  if the chosen stepsize is too smaller, the approximation becomes intensive.

\item Find a range of stepsizes which perform suitably
\end{itemize}

\end{frame}

% ====

\begin{frame}{Choosing the Integration Time}


\end{frame}

% ===============================================
\section{Optimal Acceptance Rates}
% ===============================================

\begin{frame}{Optimal Acceptance Rate: RWM}

\begin{figure}
\centering
\includegraphics[scale = 0.4]{RWM_Optimal2.png}
\end{figure}

\end{frame}

% ==== 

\begin{frame}{Optimal Acceptance Rate: RWM}
\begin{figure}
\centering
\includegraphics[scale = 0.4]{RWM_Optimal4.png}
\end{figure}
\end{frame}

% ==== 

\begin{frame}{Optimal Acceptance Rate: RWM}
\begin{figure}
\centering
\includegraphics[scale = 0.4]{RWM_Optimal8.png}
\end{figure}
\end{frame}

% ==== 

\begin{frame}{Optimal Acceptance Rate: RWM}
\begin{figure}
\centering
\includegraphics[scale = 0.4]{RWM_Optimal8.png}
\end{figure}
\end{frame}

% ===============================================

% ===============================================

\begin{frame}{Questions}

\begin{center}
Thank you for listening.
\vskip 0.5cm
Any Questions?

\end{center}

\end{frame}


\end{document}
